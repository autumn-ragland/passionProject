{% extends 'travelApp/base.html' %}

{% block content %}
<h2>{{ request.user }}'s Travel Log</h2>
<a href="{% url 'newLog' %}"><button class="btn-primary">Add a Log</button></a>
<hr/>

{% if myLogs %}
<div class="mapAndLogs">
    <div class="listLogs">
        {% for logs in myLogs %}
        <a href="{% url 'logDetails' logs.id %}"><p class="locationName">{{logs.location}}</p></a>
        <p>{{logs.summary}}</p>

        <p class="lat">{{logs.location_lat}}</p>
        <p class="long">{{logs.location_long}}</p>
        <hr>
        {% endfor %}
    </div>
    <div id="map"></div>
</div>

{% else %}
    <h3>You have no logs</h3>
{% endif %}

<script>
    var long_array = [];
    var lat_array = [];
    var location_name = [];

    let locationLong = document.getElementsByClassName("long");
    for (let i = 0; i < locationLong.length; i++) {
        long_array.push(parseInt(locationLong[i].innerHTML))
    }

    let locationLat = document.getElementsByClassName("lat");
    for (let i = 0; i < locationLat.length; i++) {
        lat_array.push(parseInt(locationLat[i].innerHTML))
    }

    let locationName = document.getElementsByClassName("locationName");
    for (let i = 0; i < locationName.length; i++) {
        location_name.push(locationName[i].innerHTML)
    }

    console.log(long_array);
    console.log(lat_array);

    function initMap() {

        let myLatLng = {lat: 35, lng: -90};

        map = new google.maps.Map(document.getElementById('map'), {
            center: myLatLng,
            zoom: 4
        });

        setMarkers(map)
    }

    function setMarkers(map){
        for (let i = 0; i < lat_array.length; i++) {
            let marker = new google.maps.Marker({
                position: {lat: lat_array[i], lng: long_array[i]},
                map: map,
                title: location_name[i],
            });
        }
    }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAcVeR1EcysjeZr4eQE_mtiJ6suMxXY52Y&callback=initMap"
        async defer></script>
{% endblock %}
